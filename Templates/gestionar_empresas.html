{% extends "index.html" %}

{% block title %}Gestionar Empresas TurÃ­sticas{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/resumen_sistema.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/gestionar_empresas.css') }}">
{% endblock %}

{% block header %}
<div class="header-custom text-white px-4 py-3 d-flex flex-column align-items-center">
    <h1 class="h3 mb-1 font-weight-bold">
        GestiÃ³n de Empresas TurÃ­sticas
    </h1>
    <span class="lead font-weight-semibold">
        DirecciÃ³n de Turismo - Ciudad de Esperanza
    </span>
</div>
{% endblock %}

{% block content %}
        <!-- SecciÃ³n de estadÃ­sticas -->
        <div class="section">
            <h2>ğŸ“Š Resumen del Sistema</h2>
            <div class="estadisticas-grid">
                <div class="stat-card identidad">
                    <div class="stat-number">{{ empresas|selectattr('categoria', 'equalto', 'identidad')|list|length }}</div>
                    <div class="stat-label">Turismo de Identidad</div>
                </div>
                <div class="stat-card educativo">
                    <div class="stat-number">{{ empresas|selectattr('categoria', 'equalto', 'educativo')|list|length }}</div>
                    <div class="stat-label">Turismo Educativo</div>
                </div>
                <div class="stat-card total">
                    <div class="stat-number">{{ empresas|length }}</div>
                    <div class="stat-label">Total de Empresas</div>
                </div>
            </div>
        </div>

        <!-- SecciÃ³n de acciones -->
        <div class="section">
            <div class="botones">
                <a href="{{ url_for('agregar_empresa') }}" class="boton-enviar">
                    Agregar Nueva Empresa
                </a>
                <a href="{{ url_for('index') }}" class="boton-volver">
                    Volver al MenÃº Principal
                </a>
            </div>
        </div>

        <!-- SecciÃ³n de listado -->
        <div class="section">
            <h2>ğŸ“‹ Listado de Empresas</h2>
            <div class="tabla-container">
                <table class="tabla-empresas">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>ğŸ¢ Empresa</th>
                            <th>ğŸ“§ Email</th>
                            <th>ğŸ“ TelÃ©fono</th>
                            <th>ğŸ¯ CategorÃ­a</th>
                            <th>âš™ï¸ Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if empresas|length == 0 %}
                        <tr>
                            <td colspan="6" class="sin-datos">
                                <div class="mensaje-vacio">
                                    <h3>ğŸ“­ No hay empresas registradas</h3>
                                    <p>Comience agregando la primera empresa turÃ­stica al sistema.</p>
                                    <a href="{{ url_for('agregar_empresa') }}" class="boton-enviar">â• Agregar Primera Empresa</a>
                                </div>
                            </td>
                        </tr>
                        {% else %}
                        {% for empresa in empresas %}
                        <tr>
                            <td class="id-celda">#{{ empresa.id }}</td>
                            <td class="empresa-celda">
                                <div class="empresa-info">
                                    <strong>{{ empresa.nombre }}</strong>
                                    {% if empresa.direccion %}
                                    <small>ğŸ“ {{ empresa.direccion }}</small>
                                    {% endif %}
                                </div>
                            </td>
                            <td class="email-celda">{{ empresa.email or '' }}</td>
                            <td class="telefono-celda">{{ empresa.telefono or 'No especificado' }}</td>
                            <td class="categoria-celda">
                                <span class="categoria-badge {{ empresa.categoria }}">
                                    {% if empresa.categoria == 'identidad' %}
                                    ğŸ›ï¸ Identidad
                                    {% else %}
                                    ğŸ“ Educativo
                                    {% endif %}
                                </span>
                            </td>
                            <td class="acciones-celda">
                                <div class="acciones-grupo">
                                    <a href="{{ url_for('editar_empresa', empresa_id=empresa.id) }}" 
                                       class="boton-accion editar" 
                                       title="Editar empresa">
                                        âœï¸ Editar
                                    </a>
                                    <form method="POST" action="{{ url_for('eliminar_empresa', empresa_id=empresa.id) }}" 
                                          style="display: inline;" 
                                          onsubmit="return confirm('Â¿EstÃ¡ seguro de eliminar la empresa {{ empresa.nombre }}?')">
                                        <button type="submit" 
                                                class="boton-accion eliminar" 
                                                title="Eliminar empresa">
                                            ï¿½ï¸ Eliminar
                                        </button>
                                    </form>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- InformaciÃ³n adicional -->
        {% if empresas|length > 0 %}
        <div class="section">
            <h2>â„¹ï¸ InformaciÃ³n del Sistema</h2>
            <div class="info-panel">
                <div class="info-item">
                    <strong>ğŸ¯ Turismo de Identidad:</strong> 
                    Para instituciones locales de Esperanza que buscan conocer su patrimonio cultural.
                </div>
                <div class="info-item">
                    <strong>ğŸ“ Turismo Educativo:</strong> 
                    Para instituciones externas que visitan la ciudad con fines educativos.
                </div>
                <div class="info-item">
                    <strong>ğŸ“š Niveles Educativos:</strong> 
                    El sistema maneja Ãºnicamente Primario y Secundario segÃºn las especificaciones de la DirecciÃ³n de Turismo.
                </div>
            </div>
        </div>
        {% endif %}
    </div>

{% endblock %}
