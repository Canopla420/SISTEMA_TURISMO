{% extends "index.html" %}

{% block title %}Solicitud de Visita Tur√≠stica{% endblock %}

{% block header %}
<div class="header-custom text-white px-4 py-3 d-flex flex-column align-items-center">
    <h1 class="h3 mb-1 font-weight-bold">
        <i class="fas fa-university mr-2"></i>
        Sistema de Gesti√≥n de Visitas Tur√≠sticas
    </h1>
    <span class="lead font-weight-semibold">
        Direcci√≥n de Turismo - Ciudad de Esperanza
    </span>
</div>
{% endblock %}

{% block content %}
<!-- Informaci√≥n del proceso -->
<div class="section">
    <div class="info-panel">
        <div class="info-item">
            <strong>üìã Proceso de solicitud:</strong> 
            1. Complete los datos ‚Üí 2. Seleccione empresas ‚Üí 3. Proponga fechas ‚Üí 4. Env√≠e la solicitud
        </div>
        <div class="info-item">
            <strong>üéØ Filtrado autom√°tico:</strong> 
            Las empresas disponibles se mostrar√°n autom√°ticamente seg√∫n el tipo de instituci√≥n y nivel educativo seleccionados.
        </div>
    </div>
</div>

<form action="/institucion/solicitar_visita" method="POST" class="form-solicitud">
    <!-- A. DATOS DE LA INSTITUCI√ìN -->
    <div class="section">
        <h2>A. Datos de la Instituci√≥n</h2>
        <div class="form-group">
            <label for="nombre_institucion">Nombre completo de la instituci√≥n educativa:</label>
            <input type="text" id="nombre_institucion" name="nombre_institucion" required>
        </div>
        <div class="form-group">
            <label for="localidad">Localidad:</label>
            <input type="text" id="localidad" name="localidad" required>
        </div>
        <div class="form-group">
            <label for="tipo_institucion">Tipo de instituci√≥n:</label>
            <select id="tipo_institucion" name="tipo_institucion" required>
                <option value="">Seleccione una opci√≥n</option>
                <option value="local">Instituci√≥n Local (Esperanza)</option>
                <option value="externa">Instituci√≥n Externa (Turismo Educativo)</option>
            </select>
        </div>
        <div class="form-group">
            <label for="director">Nombre del director/a:</label>
            <input type="text" id="director" name="director" required>
        </div>
        <div class="form-group">
            <label for="correo_institucional">Correo electr√≥nico institucional:</label>
            <input type="email" id="correo_institucional" name="correo_institucional" required>
        </div>
        <div class="form-group">
            <label for="telefono_institucion">N√∫mero de tel√©fono de la instituci√≥n:</label>
            <input type="tel" id="telefono_institucion" name="telefono_institucion" required>
        </div>
    </div>

    <!-- B. DATOS DEL CONTINGENTE -->
    <div class="section">
        <h2>B. Datos del Contingente</h2>
        <div class="form-group">
            <label for="contacto_principal">Nombre completo del contacto principal:</label>
            <input type="text" id="contacto_principal" name="contacto_principal" required>
        </div>
        <div class="form-group">
            <label for="telefono_contacto_principal">N√∫mero de tel√©fono del contacto principal:</label>
            <input type="tel" id="telefono_contacto_principal" name="telefono_contacto_principal" required>
        </div>
        <div class="form-group">
            <label for="relacion_contacto">Relaci√≥n del contacto principal con el grupo:</label>
            <input type="text" id="relacion_contacto" name="relacion_contacto" required>
        </div>
        <div class="form-group">
            <label for="contacto_suplente">Nombre completo del contacto suplente:</label>
            <input type="text" id="contacto_suplente" name="contacto_suplente">
        </div>
        <div class="form-group">
            <label for="telefono_contacto_suplente">N√∫mero de tel√©fono del contacto suplente:</label>
            <input type="tel" id="telefono_contacto_suplente" name="telefono_contacto_suplente">
        </div>
        <div class="form-group">
            <label for="nivel_educativo">Nivel educativo del grupo:</label>
            <select id="nivel_educativo" name="nivel_educativo" required>
                <option value="">Seleccione el nivel educativo</option>
                <option value="Primario">Nivel Primario</option>
                <option value="Secundario">Nivel Secundario</option>
            </select>
        </div>
        <div class="form-group">
            <label for="cantidad_alumnos">Cantidad total de alumnos:</label>
            <input type="number" id="cantidad_alumnos" name="cantidad_alumnos" required>
        </div>
        <div class="form-group">
            <label for="edad_alumnos">Edad o rango etario de los alumnos:</label>
            <input type="text" id="edad_alumnos" name="edad_alumnos" required>
        </div>
        <div class="form-group">
            <label>¬øHay alumnos/as con discapacidad?</label>
            <div>
                <input type="radio" id="discapacidad_si" name="discapacidad" value="S√≠" required>
                <label for="discapacidad_si">S√≠</label>
                <input type="radio" id="discapacidad_no" name="discapacidad" value="No" required>
                <label for="discapacidad_no">No</label>
            </div>
        </div>
        <div class="form-group">
            <label for="tipo_discapacidad">Tipo de discapacidad (si aplica):</label>
            <input type="text" id="tipo_discapacidad" name="tipo_discapacidad">
        </div>
        <div class="form-group">
            <label>¬øRequiere adaptaci√≥n?</label>
            <div>
                <input type="radio" id="adaptacion_si" name="adaptacion" value="S√≠">
                <label for="adaptacion_si">S√≠</label>
                <input type="radio" id="adaptacion_no" name="adaptacion" value="No">
                <label for="adaptacion_no">No</label>
            </div>
        </div>
    </div>

    <!-- C. SELECCI√ìN DE EMPRESAS A VISITAR -->
    <div class="section">
        <h2>C. Selecci√≥n de Empresas a Visitar</h2>
        {% if empresas %}
            <p>üìù Seleccione las empresas que desea visitar:</p>
            <div class="lugares-container" id="empresas-container">
                {% for empresa in empresas %}
                <div class="lugar-item">
                    <input type="checkbox" id="empresa_{{ empresa.id }}" name="empresas_seleccionadas" value="{{ empresa.id }}">
                    <label for="empresa_{{ empresa.id }}" class="lugar-label">
                        <div class="lugar-info">
                            <h4>üè¢ {{ empresa.nombre }}</h4>
                            <p class="categoria">üìÇ {{ empresa.categoria }}</p>
                            <p class="contacto">üìß {{ empresa.email }}</p>
                            <p class="contacto">üìû {{ empresa.telefono }}</p>
                        </div>
                    </label>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="info-panel warning">
                <p>‚ö†Ô∏è No hay empresas registradas a√∫n.</p>
                <p>Primero debe <a href="/gestionar_empresas" target="_blank">registrar empresas</a> para poder solicitar visitas.</p>
            </div>
        {% endif %}
        <div class="form-group">
            <label for="observaciones_empresas">Observaciones adicionales sobre las empresas seleccionadas:</label>
            <textarea id="observaciones_empresas" name="observaciones_empresas" rows="3" placeholder="Ej: Inter√©s especial en el √°rea de producci√≥n, horarios preferidos, etc."></textarea>
        </div>
    </div>

    <!-- D. FECHA Y HORARIO PROPUESTO -->
    <div class="section">
        <h2>D. Fecha y Horario Propuesto</h2>
        <p>Indique la fecha y el horario sugerido para la visita:</p>
        <div class="form-group">
            <label for="fecha_visita">Fecha sugerida de la visita:</label>
            <input type="date" id="fecha_visita" name="fecha_visita" required>
        </div>
        <div class="form-group">
            <label for="hora_grupo1">Hora propuesta para el grupo 1:</label>
            <input type="time" id="hora_grupo1" name="hora_grupo1">
        </div>
        <div class="form-group">
            <label for="hora_grupo2">Hora propuesta para el grupo 2:</label>
            <input type="time" id="hora_grupo2" name="hora_grupo2">
        </div>
        <div class="form-group">
            <label for="observaciones">Observaciones adicionales:</label>
            <textarea id="observaciones" name="observaciones" placeholder="Escriba aqu√≠ cualquier detalle adicional..."></textarea>
        </div>
    </div>

    <!-- Bot√≥n Final -->
    <div class="botones">
        <button type="submit" class="boton-enviar">
            üì® Enviar Solicitud
        </button>
        <a href="{{ url_for('index') }}" class="boton-volver">
            üè† Volver al Men√∫
        </a>
    </div>
</form>

<!-- Informaci√≥n adicional -->
<div class="section">
    <h2>‚ÑπÔ∏è Informaci√≥n Importante</h2>
    <div class="info-panel">
        <div class="info-item">
            <strong>‚è∞ Tiempo de respuesta:</strong> 
            Su solicitud ser√° procesada en un plazo de 48-72 horas h√°biles.
        </div>
        <div class="info-item">
            <strong>üìû Contacto:</strong> 
            Para consultas urgentes, comun√≠quese con la Direcci√≥n de Turismo de Esperanza.
        </div>
        <div class="info-item">
            <strong>üìö Niveles admitidos:</strong> 
            El sistema est√° configurado para instituciones de nivel Primario y Secundario √∫nicamente.
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    /* ...tu CSS espec√≠fico de la p√°gina aqu√≠... */
</style>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/validaciones.js') }}"></script>
{% endblock %}